from bs4 import BeautifulSoup
from http_connection import get_hosts_content


def get_hosts_links():
    '''Gets and returns the possible links for a SQL injection attack as a
    dictionary with hosts IPs as keys and a list of links as values'''

    data = get_hosts_content(False)
    hosts_links = {}

    for host, text in data.items():
        soup = BeautifulSoup(text, 'html.parser')
        hosts_links[host] = []

        forms = soup.find_all('form')

        if forms:
            for form in forms:
                action = form.get('action')
                if action:
                    hosts_links[host].append(action)

        # It works for both the page has no forms or the action attributes in
        # the forms of the page have no value
        if not hosts_links[host]:
            for anchor in soup.find_all('a'):
                link = anchor.get('href')
                if link:
                    hosts_links[host].append(link)

    return hosts_links


if __name__ == '__main__':
    print(get_hosts_links())
